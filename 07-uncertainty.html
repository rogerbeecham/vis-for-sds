<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.637">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Visualization for Social Data Science - 7&nbsp; Uncertainty</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-storytelling.html" rel="next">
<link href="./06-model.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Uncertainty</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualization for Social Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/vis4sds/vis4sds/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/intent/tweet?url=%7Curl%7C" title="Twitter" class="sidebar-tool px-1"><i class="bi bi-twitter"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Fundamentals</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-visual.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Visualization Fundamentals</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-explore.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-network.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Networks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-uncertainty.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Uncertainty</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-storytelling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Storytelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"> <span class="header-section-number">7.1</span> Introduction</a></li>
  <li>
<a href="#concepts" id="toc-concepts" class="nav-link" data-scroll-target="#concepts"> <span class="header-section-number">7.2</span> Concepts</a>
  <ul class="collapse">
<li><a href="#uncertainty-visualization" id="toc-uncertainty-visualization" class="nav-link" data-scroll-target="#uncertainty-visualization"> <span class="header-section-number">7.2.1</span> Uncertainty visualization</a></li>
  <li><a href="#frequency-framing" id="toc-frequency-framing" class="nav-link" data-scroll-target="#frequency-framing"> <span class="header-section-number">7.2.2</span> Frequency framing</a></li>
  <li><a href="#quantifying-uncertainty-in-frequencies" id="toc-quantifying-uncertainty-in-frequencies" class="nav-link" data-scroll-target="#quantifying-uncertainty-in-frequencies"> <span class="header-section-number">7.2.3</span> Quantifying uncertainty in frequencies</a></li>
  <li><a href="#visualizing-uncertainty-in-frequencies" id="toc-visualizing-uncertainty-in-frequencies" class="nav-link" data-scroll-target="#visualizing-uncertainty-in-frequencies"> <span class="header-section-number">7.2.4</span> Visualizing uncertainty in frequencies</a></li>
  </ul>
</li>
  <li><a href="#techniques" id="toc-techniques" class="nav-link" data-scroll-target="#techniques"> <span class="header-section-number">7.3</span> Techniques</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/vis4sds/vis4sds/edit/master/07-uncertainty.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-uncertainty" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Uncertainty</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div class="cell">

</div>
<p>By the end of this chapter you should gain the following knowledge and practical skills.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Knowledge
</div>
</div>
<div class="callout-body-container callout-body">
<ul class="task-list">
<li>
<input type="checkbox" disabled="" checked="">
Appreciate the main challenges and objectives of uncertainty representation.</li>
<li>
<input type="checkbox" disabled="" checked="">
Learn how visualization techniques can be used to support ‘frequency framing’ – the perception of probability and risk.</li>
<li>
<input type="checkbox" disabled="" checked="">
Understand how parameter uncertainty can be estimated computationally.</li>
</ul>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Practical skills
</div>
</div>
<div class="callout-body-container callout-body">
<ul class="task-list">
<li>
<input type="checkbox" disabled="" checked="">
Create uncertainty visualizations in <code>ggplot2</code>.</li>
<li>
<input type="checkbox" disabled="" checked="">
Generate estimates of parameter uncertainty using bootstrap resampling.</li>
<li>
<input type="checkbox" disabled="" checked="">
Apply <a href="https://purrr.tidyverse.org/articles/other-langs.html">functional-style programming</a> for working over bootstrap resamples.</li>
</ul>
</div>
</div>
<section id="introduction" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">7.1</span> Introduction</h2>
<p>Uncertainty is a key preoccupation of those working in statistics and data analysis. A lot of time is spent providing estimates for it, reasoning about it and trying to take it into account when making evidence-based claims and decisions. There are many ways in which uncertainty can enter a data analysis and many ways in which it can be conceptually represented. This chapter focuses mainly on parameter uncertainty – that is, quantifying and conveying the different possible values that a quantity of interest might take. Intuitively, visualization should help with providing support here. We can use data graphics to represent these different values and give greater emphasis to those for which we have greater certainty – to communicate or <em>imply</em> levels of uncertainty in the background. This is, however, quite challenging. In <a href="03-visual.html"><span>Chapter&nbsp;3</span></a>, we learnt that there is often a gap between the visual encoding of data and its perception and the tendency in standard data graphics to imbue data with marks that over-imply precision. We will consider research in Cartography and Information Visualization on representing uncertainty information, before exploring and applying techniques for quantifying and visually representing parameter uncertainty. We will do so using <a href="https://data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data">STATS19</a> road safety data, exploring how injury severity rates in pedestrian-vehicle crashes vary over time and by geographic area.</p>
</section><section id="concepts" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="concepts">
<span class="header-section-number">7.2</span> Concepts</h2>
<section id="uncertainty-visualization" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="uncertainty-visualization">
<span class="header-section-number">7.2.1</span> Uncertainty visualization</h3>
<p>Cartographers, and more recently those working in Information Visualization, have been concerned for some time with <em>visual variables</em>, or adopting <span class="citation" data-cites="munzner_visualization_2014">Munzner (<a href="references.html#ref-munzner_visualization_2014" role="doc-biblioref">2014</a>)</span>’s vocabulary <em>visual channels</em>, that might be used to represent uncertainty information. <a href="#fig-uncertainty-variables">Figure&nbsp;<span>7.1</span></a> is adapted from <span class="citation" data-cites="kinkeldey_how_2014">Kinkeldey, MacEachren, and Schiewe (<a href="references.html#ref-kinkeldey_how_2014" role="doc-biblioref">2014</a>)</span> and displays visual variables that could be used to encode uncertainty information. Ideally, visual variables for representing uncertainty should be intuitive, logically related to notions of precision and accuracy, whilst also allowing sufficient discriminative power when deployed in data dense visualizations.</p>
<p><span class="citation" data-cites="kinkeldey_how_2014">Kinkeldey, MacEachren, and Schiewe (<a href="references.html#ref-kinkeldey_how_2014" role="doc-biblioref">2014</a>)</span> provides an overview of empirical research that explore the effectiveness of proposed visual variables against these criteria. As intuitive signifiers of uncertainty, or lack of precision, <em>fuzziness</em> (not encoded in <a href="#fig-uncertainty-variables">Figure&nbsp;<span>7.1</span></a>) and <em>location</em> have been shown to work well. Slightly less intuitive, but nevertheless successful in terms of discrimination are <em>size</em>, <em>transparency</em> and <em>colour value</em>. <em>Sketchiness</em> is another intuitive signifier, proposed in <span class="citation" data-cites="boukhelifa_evaluating_2012">Boukhelifa et al. (<a href="references.html#ref-boukhelifa_evaluating_2012" role="doc-biblioref">2012</a>)</span> and <span class="citation" data-cites="wood_sketchy_2012">Wood et al. (<a href="references.html#ref-wood_sketchy_2012" role="doc-biblioref">2012</a>)</span>. As with many visual variables, sketchiness is probably best considered as an ordinal visual variable to the extent that there is a limited range of sketchiness levels that can be discriminated. An additional feature of sketchiness is that, different from the other visual variables, it is related to informality – this may be desirable in certain contexts, less so in others <span class="citation" data-cites="wood_sketchy_2012">(see <a href="references.html#ref-wood_sketchy_2012" role="doc-biblioref">Wood et al. 2012</a>)</span>.</p>
<div class="cell" data-include="false">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="50" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 49;"><span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">rStyle</span>(roughness) {</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> rStyle <span class="op">=</span> {<span class="dt">roughness</span><span class="op">:</span> roughness}<span class="op">;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  rStyle<span class="op">;</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(rStyle)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">drawPointsSketch</span>(r<span class="op">,</span> pts) {</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  pts<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(d) { </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span><span class="fu">setRoughStyle</span>(<span class="fu">rStyle</span>(d<span class="op">.</span><span class="at">roughness</span>))</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fill</span>(<span class="st">"#636363"</span>)<span class="op">.</span><span class="fu">ellipse</span>(d<span class="op">.</span><span class="at">x</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span><span class="op">,</span> <span class="op">.</span><span class="dv">3</span>)} )</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">drawPointsSize</span>(r<span class="op">,</span> pts) {</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  pts<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(d) { r<span class="op">.</span><span class="fu">fill</span>(<span class="st">"#636363"</span>)<span class="op">.</span><span class="fu">strokeWidth</span>(<span class="dv">0</span>)<span class="op">.</span><span class="fu">ellipse</span>(d<span class="op">.</span><span class="at">x</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span><span class="op">,</span> d<span class="op">.</span><span class="at">size</span>)} )</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">drawPointsColour</span>(r<span class="op">,</span> pts) {</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  pts<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(d) { r<span class="op">.</span><span class="fu">fill</span>(d<span class="op">.</span><span class="at">cls</span>)<span class="op">.</span><span class="fu">strokeWidth</span>(<span class="dv">0</span>)<span class="op">.</span><span class="fu">ellipse</span>(d<span class="op">.</span><span class="at">x</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span><span class="op">,</span> <span class="op">.</span><span class="dv">3</span>)} )</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">drawPointsAlpha</span>(r<span class="op">,</span> pts) {</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  pts<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(d) { </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span><span class="fu">strokeWidth</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">stroke</span>(d<span class="op">.</span><span class="at">alphs</span>)<span class="op">.</span><span class="fu">fill</span>(<span class="st">"#ffffff00"</span>)<span class="op">.</span><span class="fu">ellipse</span>(d<span class="op">.</span><span class="at">x</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span><span class="op">,</span> <span class="op">.</span><span class="dv">35</span>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span><span class="fu">strokeWidth</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">line</span>([[d<span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [d<span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="fl">1.35</span>]])</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span><span class="fu">line</span>([[d<span class="op">.</span><span class="at">x</span><span class="op">-.</span><span class="dv">35</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span>]<span class="op">,</span> [d<span class="op">.</span><span class="at">x</span><span class="op">+.</span><span class="dv">35</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span>]])</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span><span class="fu">fill</span>(d<span class="op">.</span><span class="at">alphs</span>)<span class="op">.</span><span class="fu">strokeWidth</span>(<span class="dv">0</span>)<span class="op">.</span><span class="fu">ellipse</span>(d<span class="op">.</span><span class="at">x</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span><span class="op">,</span> <span class="op">.</span><span class="dv">25</span>)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    } )</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">drawPointsLocation</span>(r<span class="op">,</span> pts) {</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  pts<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(d) {</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span><span class="fu">strokeWidth</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">stroke</span>(<span class="st">"#636363"</span>)<span class="op">.</span><span class="fu">fill</span>(<span class="st">"#ffffff00"</span>)<span class="op">.</span><span class="fu">ellipse</span>(d<span class="op">.</span><span class="at">x</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span><span class="op">,</span> <span class="op">.</span><span class="dv">35</span>)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span><span class="fu">strokeWidth</span>(<span class="op">.</span><span class="dv">8</span>)<span class="op">.</span><span class="fu">line</span>([[d<span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [d<span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="fl">1.35</span>]])</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span><span class="fu">line</span>([[d<span class="op">.</span><span class="at">x</span><span class="op">-.</span><span class="dv">35</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span>]<span class="op">,</span> [d<span class="op">.</span><span class="at">x</span><span class="op">+.</span><span class="dv">35</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span>]])</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span><span class="fu">strokeWidth</span>(<span class="dv">0</span>)<span class="op">.</span><span class="fu">fill</span>(<span class="st">"#636363"</span>)<span class="op">.</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ellipse</span>(</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">x</span> <span class="op">+</span> ((<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>()) <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span>)<span class="op">*</span> <span class="op">.</span><span class="dv">5</span><span class="op">*</span>(d<span class="op">.</span><span class="at">location</span>))<span class="op">,</span> </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">y</span> <span class="op">+</span> ((<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>()) <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span>)<span class="op">*</span> <span class="op">.</span><span class="dv">5</span><span class="op">*</span>(d<span class="op">.</span><span class="at">location</span>))<span class="op">,</span> </span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="bn">05</span>)</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    } )</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell" data-include="false">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="101" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 100;"><span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Renderer } <span class="im">from</span> <span class="st">"@jwolondon/renderer"</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { aq<span class="op">,</span> op } <span class="im">from</span> <span class="st">'@uwdata/arquero'</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> <span class="dv">480</span><span class="op">;</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>border <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>testDat <span class="op">=</span> aq<span class="op">.</span><span class="fu">table</span>({</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> [<span class="fl">2.2</span><span class="op">,</span> <span class="fl">3.2</span><span class="op">,</span> <span class="fl">4.2</span><span class="op">,</span> <span class="fl">5.2</span><span class="op">,</span> <span class="fl">6.2</span><span class="op">,</span> <span class="fl">7.2</span>]<span class="op">,</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>    <span class="dt">size</span><span class="op">:</span> [<span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">25</span><span class="op">,</span> <span class="op">.</span><span class="dv">2</span><span class="op">,</span> <span class="op">.</span><span class="dv">15</span><span class="op">,</span> <span class="op">.</span><span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>    <span class="dt">cls</span><span class="op">:</span> [<span class="st">"#252525"</span><span class="op">,</span> <span class="st">"#525252"</span><span class="op">,</span> <span class="st">"#737373"</span><span class="op">,</span> <span class="st">"#969696"</span><span class="op">,</span> <span class="st">"#bdbdbd"</span><span class="op">,</span> <span class="st">"#d9d9d9"</span>]<span class="op">,</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>    <span class="dt">alphs</span><span class="op">:</span> [<span class="st">"#252525E6"</span><span class="op">,</span> <span class="st">"#252525BF"</span><span class="op">,</span> <span class="st">"#25252599"</span><span class="op">,</span> <span class="st">"#25252573"</span><span class="op">,</span> <span class="st">"#25252559"</span><span class="op">,</span> <span class="st">"#25252533"</span>]<span class="op">,</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>    <span class="dt">location</span><span class="op">:</span> [<span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="op">.</span><span class="dv">18</span><span class="op">,</span> <span class="op">.</span><span class="dv">25</span><span class="op">,</span> <span class="op">.</span><span class="dv">32</span><span class="op">,</span> <span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">45</span>]<span class="op">,</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="dt">roughness</span><span class="op">:</span> [<span class="fl">0.2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="fl">4.2</span><span class="op">,</span> <span class="fl">6.5</span>]</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>xSc <span class="op">=</span> d3</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span><span class="fl">9.5</span>])</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">range</span>([border<span class="op">,</span> w <span class="op">-</span> border])<span class="op">;</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>ySc <span class="op">=</span> d3</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="fl">0.5</span><span class="op">,</span> <span class="fl">1.5</span>])</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([h <span class="op">-</span> border<span class="op">,</span> border])<span class="op">;</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>r0 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Renderer</span>(w<span class="op">,</span> h<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="st">"svg"</span>)</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setScales</span>(xSc<span class="op">,</span> ySc)</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">font</span>(<span class="st">"Avenir Next Ultra Light"</span>)</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textAlign</span>(<span class="st">"left"</span>)</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textBaseline</span>(<span class="st">"middle"</span>)</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textSize</span>(<span class="dv">10</span>)</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">"certain"</span><span class="op">,</span><span class="fl">1.8</span><span class="op">,</span><span class="dv">1</span>)</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textAlign</span>(<span class="st">"right"</span>)</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">"uncertain"</span><span class="op">,</span> <span class="fl">7.3</span><span class="op">,</span><span class="dv">1</span>)</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">line</span>([[<span class="fl">2.8</span><span class="op">,</span><span class="dv">1</span>]<span class="op">,</span> [<span class="dv">6</span><span class="op">,</span><span class="dv">1</span>]])</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>r0<span class="op">.</span><span class="fu">render</span>()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="139" data-source-offset="-944"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 138;"><span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>r1 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Renderer</span>(w<span class="op">,</span> h<span class="op">,</span> <span class="st">"svg"</span>)</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setScales</span>(xSc<span class="op">,</span> ySc)</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">font</span>(<span class="st">"Avenir Next Ultra Light"</span>)</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textAlign</span>(<span class="st">"left"</span>)</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textBaseline</span>(<span class="st">"middle"</span>)</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textSize</span>(<span class="dv">10</span>)</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">"size"</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span>)</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a><span class="fu">drawPointsSize</span>(r1<span class="op">,</span> testDat<span class="op">.</span><span class="fu">objects</span>())<span class="op">.</span><span class="fu">render</span>()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-12" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="148" data-source-offset="-1165"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 147;"><span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Renderer</span>(w<span class="op">,</span> h<span class="op">,</span> <span class="st">"svg"</span>)</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setScales</span>(xSc<span class="op">,</span> ySc)</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">font</span>(<span class="st">"Avenir Next Ultra Light"</span>)</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textAlign</span>(<span class="st">"left"</span>)</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textBaseline</span>(<span class="st">"middle"</span>)</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textSize</span>(<span class="dv">10</span>)</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">"colour"</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span>)</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a><span class="fu">drawPointsColour</span>(r2<span class="op">,</span> testDat<span class="op">.</span><span class="fu">objects</span>())<span class="op">.</span><span class="fu">render</span>()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-14" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="157" data-source-offset="-1390"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 156;"><span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>r3 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Renderer</span>(w<span class="op">,</span> h<span class="op">,</span> <span class="st">"svg"</span>)</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setScales</span>(xSc<span class="op">,</span> ySc)</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">font</span>(<span class="st">"Avenir Next Ultra Light"</span>)</span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textAlign</span>(<span class="st">"left"</span>)</span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textBaseline</span>(<span class="st">"middle"</span>)</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textSize</span>(<span class="dv">10</span>)</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">"transparency"</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span>)</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a><span class="fu">drawPointsAlpha</span>(r3<span class="op">,</span> testDat<span class="op">.</span><span class="fu">objects</span>())<span class="op">.</span><span class="fu">render</span>()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-16" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="166" data-source-offset="-1620"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 165;"><span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>r4 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Renderer</span>(w<span class="op">,</span> h<span class="op">,</span> <span class="st">"svg"</span>)</span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setScales</span>(xSc<span class="op">,</span> ySc)</span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">font</span>(<span class="st">"Avenir Next Ultra Light"</span>)</span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textAlign</span>(<span class="st">"left"</span>)</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textBaseline</span>(<span class="st">"middle"</span>)</span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textSize</span>(<span class="dv">10</span>)</span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">"location"</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span>)</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a><span class="fu">drawPointsLocation</span>(r4<span class="op">,</span> testDat<span class="op">.</span><span class="fu">objects</span>())<span class="op">.</span><span class="fu">render</span>()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-18" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="175" data-source-offset="-1849"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 174;"><span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>r5 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Renderer</span>(w<span class="op">,</span> h<span class="op">,</span> <span class="st">"roughsvg"</span>)</span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setScales</span>(xSc<span class="op">,</span> ySc)</span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">font</span>(<span class="st">"Avenir Next Ultra Light"</span>)</span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textAlign</span>(<span class="st">"left"</span>)</span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textBaseline</span>(<span class="st">"middle"</span>)</span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">textSize</span>(<span class="dv">10</span>)</span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">"sketchy"</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span>)</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a><span class="fu">drawPointsSketch</span>(r5<span class="op">,</span> testDat<span class="op">.</span><span class="fu">objects</span>())<span class="op">.</span><span class="fu">render</span>()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-20" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-uncertainty-variables" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/07/uncertainty_vars.png" class="img-fluid figure-img" style="width:65.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 7.1: Visual variables that can be used to represent levels of uncertainty information</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>From within the Uncertainty Visualization literature, a key maxim that consistently appears for successful uncertainty visualization is that:</p>
<blockquote class="blockquote">
<p><em>Things that are not precise should not be encoded with symbols that look precise.</em></p>
</blockquote>
<p>An example appearing in many primers on uncertainty visualization is the <a href="https://www.nhc.noaa.gov/">National Hurricane Center’s</a> <span class="citation" data-cites="nhc_cone_2023">(<a href="references.html#ref-nhc_cone_2023" role="doc-biblioref">NHC 2023</a>)</span> cone graphic used to represent major storm events (<a href="#fig-hurricane-vis">Figure&nbsp;<span>7.2</span></a>). The cone starts at the storm’s current location and spreads out to represent the <em>projected path</em> of the storm as determined by National Hurricane Center’s modelling. The main problem is that the cone implies that the storm is growing as we move away from its current location, when in fact this is not the case. Instead there is <em>more uncertainty</em> in the areas that could be affected by the storm the further away those areas are from the storm’s current location. The second problem is that the cone uses strong lines that imply precision. The temptation is to think that anything contained by the cone is unsafe and anything outside of it is safe. This is of course not what is suggested by the model; rather that areas beyond the cone fall outside some chosen threshold probability. You will notice that the graphic in <a href="#fig-nhc">Figure&nbsp;<span>7.2 (a)</span></a> is annotated with a guidance note to discourage such false interpretation.</p>
<p>In <span class="citation" data-cites="van_goethem_stenomaps_2014">Van Goethem et al. (<a href="references.html#ref-van_goethem_stenomaps_2014" role="doc-biblioref">2014</a>)</span>’s redesign, <em>colour value</em> is used to represent four binned categories of storm probability suggested by the model. Administrative boundaries in maps tend to induce quite specific and binary judgements about response based on this context. For example, if the cone is <em>close to</em> but not overlapping a state boundary, a decision might be made not to mount a response/prepare for the hurricane. The approach to address this in <a href="#fig-nhc-redesign">Figure&nbsp;<span>7.2 (b)</span></a> is to symbolise states using a single line, generated via curve schematisation <span class="citation" data-cites="van_goethem_stenomaps_2014">(<a href="references.html#ref-van_goethem_stenomaps_2014" role="doc-biblioref">Van Goethem et al. 2014</a>)</span>. This provides context but in a way that may discourage binary thinking; precise inferences of location are not possible as the area and state borders are very obviously not exact.</p>
<div id="fig-hurricane-vis" class="quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-nhc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/07/cone_uncertainty.png" class="img-fluid figure-img" data-ref-parent="fig-hurricane-vis"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(a) National Hurricane Center cone design</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-nhc-redesign" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/07/cone_redesign.png" class="img-fluid figure-img" data-ref-parent="fig-hurricane-vis"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(b) <span class="citation" data-cites="van_goethem_stenomaps_2014">Van Goethem et al. (<a href="references.html#ref-van_goethem_stenomaps_2014" role="doc-biblioref">2014</a>)</span> redesign</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 7.2: Cone of Uncertainty produced by National Hurricane Center <span class="citation" data-cites="nhc_cone_2023">(<a href="references.html#ref-nhc_cone_2023" role="doc-biblioref">NHC 2023</a>)</span> and example re-design in <span class="citation" data-cites="van_goethem_stenomaps_2014">Van Goethem et al. (<a href="references.html#ref-van_goethem_stenomaps_2014" role="doc-biblioref">2014</a>)</span></figcaption><p></p>
</figure>
</div>
</section><section id="frequency-framing" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="frequency-framing">
<span class="header-section-number">7.2.2</span> Frequency framing</h3>
<p>The visual variables in <a href="#fig-uncertainty-variables">Figure&nbsp;<span>7.1</span></a> could be used to represent different categories of uncertainty information, not just those associated with parameters – for example, locational or temporal uncertainty at data collection. The rest of the chapter addresses techniques for quantifying, and chart idioms <span class="citation" data-cites="munzner_visualization_2014">(<a href="references.html#ref-munzner_visualization_2014" role="doc-biblioref">Munzner 2014</a>)</span> for representing, parameter uncertainty: estimated injury severity rates for pedestrian-vehicle crashes in our STATS19 road crash dataset.</p>
<p>Often parameters are represented as probabilities, or <em>relative frequencies</em> – ratios or percentages describing the probability of some event happening. It is notoriously difficult to develop intuition around these sorts of relative frequencies. In the STATS19 dataset, we might wish to compare the injury severity rate of pedestrain-vehicle road crashes – the proportion of all crashes that resulted in a serious injury or fatality (KSI) – taking place between two local authority areas, say Bristol and Sheffield. There is in fact quite a difference in the injury severity rate between these two local authority areas in 2019: 15% for Bristol (35 out of 228 reported crashes were KSI) versus 50% for Sheffield (124 out of 248 reported crashes were KSI).</p>
<p>This feels like quite a large difference, but it is difficult to imagine or experience these differences in probabilities when written down or encoded visually using say bar length. <a href="https://mucollective.github.io/visualization/icon-array/">Icon arrays</a> are used extensively in health communication and have been demonstrated to be effective at communicating probabilities of event outcomes. They offload the thinking that happens when comparing ratios – the internal weighing up of numerators and denominators. In the example in <a href="#fig-icon-arrays">Figure&nbsp;<span>7.3</span></a>, icon arrays are used to compare the two injury severity rates for Bristol and Sheffield. Each crash is a square and crashes are coloured according to whether they resulted in a serious injury or fatality (KSI, dark red) or slight injury (light red). In the bottom row, cells are given a non-standard ordering, to effect something similar ro a standard stacked bar chart. Whilst this layout better supports reading-off the two recorded proportions (15% and 50% KSI), the random arrangement of cells in the icon array perhaps more intuitively communicates the differences in <em>probabilities</em> of a pedestrian crash resulting in serious injury.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-icon-arrays" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/07/icon_arrays.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 7.3: Icon array displaying injury severity rates for Pedestrian-Vehicle crashes</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>There are compelling examples of icon arrays being used in data journalism, most obviously to support communication of probabilities in political polling. You might remember that at the time of 2016 US Presidential Election, there was much criticism levelled at pollsters, even the excellent <a href="https://fivethirtyeight.com/features/why-fivethirtyeight-gave-trump-a-better-chance-than-almost-anyone-else/">FiveThirtyEight</a>, for not correctly calling the result. Huffpost gave Trump a 2% chance of winning the election, The New York Times 15% and FiveThirtyEight 28%. Clearly, the Huffpost estimate was really quite off, but thinking about FiveThirtyEight’s prediction, how surprised should we be if an outcome does in fact occur, which is predicted to happen with a probability of almost a third?</p>
<p>The <a href="https://mucollective.github.io/visualization/risk-theatre/">risk theatre</a> (<a href="#fig-risk-theatre">Figure&nbsp;<span>7.4</span></a>) is a variant of an icon array. In this case it represents polling probabilities as seats of a theatre – a dark seat represents a Trump victory. If you imagine buying a theatre ticket and being randomly allocated to a seat, how confident would you be about not sitting in a “Trump” seat in the FiveThirtyEight image? The distribution of dark seats suggests that the 28% risk of a Trump victory according to the model is not negligible.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-risk-theatre" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/07/risk_theatre.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 7.4: Risk theatre of different election eve forecasts, reimplementedin ggplot2 but based on that appearing in <a href="https://mucollective.github.io/visualization/risk-theatre/">Washington Post</a></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="quantifying-uncertainty-in-frequencies" class="level3" data-number="7.2.3"><h3 data-number="7.2.3" class="anchored" data-anchor-id="quantifying-uncertainty-in-frequencies">
<span class="header-section-number">7.2.3</span> Quantifying uncertainty in frequencies</h3>
<p>In the icon arrays above we made little of the fact that the sample size varies between the two recorded crash rates. Partly this was because the differences were reasonably small. When looking at injury severity rates across all local authorities in 2019, however, there is substantial variation in the rates and the sample size. Bromsgrove has a very low injury severity rate based on a small sample size (4%, or one out of 27 crashes resulting in KSI); Cotswold has a very high injury severity rate based on a small sample size (75%, or 14 out of 19 crashes resulting in KSI). With some prior knowledge of these areas, one might expect the difference in KSI rates to be in this direction, but would we expect the difference to be of this order of magnitude? Just eight more KSIs recorded in Bromsgrove makes its KSI rate equivalent to that of Bristol’s.</p>
<p>Although STATS19 is a population dataset to the extent that it contains data on every crash recorded by the Police, it makes sense that the more data on which our KSI rates are based, the more certainty we have in them being reliable estimates of injury severity – ones that might be used to predict injury severity in future years. So we can treat our observed injury rates as being derived from samples of an (<em>unobtainable</em>) population. Our calculated injury severity rates are <em>parameters</em> that try to represent, or estimate, this population.</p>
<p>Although this formulation might seem unnecessary, from here we can apply some statistical concepts to quantify uncertainty around our parameter estimates. We assume:</p>
<ol type="1">
<li>The variable of interest, KSI rate, has an unobtainable population mean and standard deviation.</li>
<li>That a <em>sample</em> will consist of a set of observations from this unobtainable population and that these samples could vary in size.</li>
<li>From any <em>sample</em> we can calculate a mean and standard deviation, which will differ from the population mean and standard deviation.</li>
<li>That we can derive a <em>sampling distribution</em> and generate an array of estimates that could be obtained from repeating the sampling process many, many times.</li>
<li>This range of the <em>sampling distribution</em> could then be used to quantify how precise are the estimates. Generally the larger the sampling distribution, the more precise – the less uncertain – the estimate.</li>
</ol>
<p>In <a href="06-model.html"><span>Chapter&nbsp;6</span></a> we used Confidence Intervals to estimate uncertainty around regression coefficients. These described the range of the sampling distribution – the range of values that coefficients estimated from a large number of resamples could take. From early stats courses, you might have learnt how these can be calculated using statistical theory. Better still, we can derive these empirically via <a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">bootstrapping</a>. A bootstrap resample involves taking a random sample with replacement from the original sample and of the same size as the original sample. From this resample, a parameter estimate can be derived, in this case the KSI rate. And this process can be repeated many times to generate an empirical <em>sampling distribution</em> for the parameter. The standard error can be calculated from the standard deviation of the sampling distribution. There are several reasons why bootstrapping is a really useful procedure: it can be applied to almost any sample statistic, makes no distributional assumptions and can work on quite complicated sampling designs.</p>
<p>Presented in <a href="#fig-bootstrap-selected">Figure&nbsp;<span>7.5</span></a> are KSI rates with error bars used to display 95% Confidence Intervals generated from a bootstrap procedure in which 1000 resamples were taken with replacement. Upper and lower limits were lifted from .025 and .975 percentile positions of the bootstrap sampling distribution. Assuming that the observed data are drawn from a wider (unobtainable) population, the 95% Confidence Intervals demonstrate that whilst Cotswold recorded a very large KSI rate, sampling variation means that this figure could be much lower (or higher), whereas for Bristol and Sheffield, where our KSI rate is derived from more data, the range of plausible values that the KSI rate might take due to sampling variation is much smaller – there is less uncertainty associated with their KSI rates.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-bootstrap-selected" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/07/bootstrap_selected.png" class="img-fluid figure-img" style="width:65.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 7.5: KSI rates for pedestrian-vehicle crashes in selected local authorities with 95% CIs (derived from 1000 resample bootstraps)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="visualizing-uncertainty-in-frequencies" class="level3" data-number="7.2.4"><h3 data-number="7.2.4" class="anchored" data-anchor-id="visualizing-uncertainty-in-frequencies">
<span class="header-section-number">7.2.4</span> Visualizing uncertainty in frequencies</h3>
<p>Error bars are a space-efficient way of conveying parameter uncertainty. However, remembering our maxim for uncertainty visualization – that <em>things that are not precise should not be encoded with symbols that look precise</em> – they do have problems. The hard borders can lead to binary or categorical thinking <span class="citation" data-cites="correl_error_2014">(see <a href="references.html#ref-correl_error_2014" role="doc-biblioref"><strong>correl_error_2014?</strong></a>)</span>. Certain values within a Confidence Interval are more probable than others and so we should endeavour to use a visual encoding that reflects this. Matt Kay’s excellent <a href="https://mjskay.github.io/ggdist/"><code>ggdist</code></a> package extends <code>ggplot2</code> with a range of chart types for representing these sorts of intervals. In <a href="#fig-selected-uncertainty">Figure&nbsp;<span>7.6</span></a> error bars are replaced with <em>half eye plots</em> and <em>interval bars</em>, which give greater visual saliency to parameter estimates that are more likely.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-selected-uncertainty" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/07/selected_uncertainty.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 7.6: KSI rates for pedestrian-vehicle crashes in selected local authorities with uncertainty estimates</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>STATS19 road crash data are released annually, and given the wide uncertainty bands for certain local authorities it might be instructive to explore the stability of local authority KSI rates year-on-year. In <a href="#fig-bootstrap-selected">Figure&nbsp;<span>7.5</span></a> these KSI rates are represented with the bold line and the faint lines are superimposed bootstrap resamples. The overall line probably most clearly demonstrates volatility in the KSI rates for Cotswold and Bromsgrove due to small sample sizes. The observed increase in KSI rates for Sheffield since 2015 does appear to be a genuine one, although may also be affected by uncertainty around data collection, changes to how police record injury severity.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-temporal-uncertainty" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/07/temporal_uncertainty.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 7.7: Year-on-yar KSI rates for pedestrian-vehicle crashes in selected local authorities with bootstrap resamples superimposed</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The superimposed lines in the figure above are a form of ensemble visualization. An alternative approach might have been to animate over the bootstrap resamples to generate a Hypoethetical Outcome Plot (HOP) <span class="citation" data-cites="hullman_hypothetical_2015">(<a href="references.html#ref-hullman_hypothetical_2015" role="doc-biblioref">Hullman, Resnick, and Adar 2015</a>)</span>. HOPs convey a sense of uncertainty by animating over random draws of a distribution. As there is no single outcome to anchor to (although I have actually included one below), HOPs force viewers to account for uncertainty, recognising that less probable outcomes may be possible – essentially to think distributionally. <a href="#fig-hop">Figure&nbsp;<span>7.8</span></a> displays frames from a HOP</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hop" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figs/07/hop.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 7.8: Frames from hypothetical outcome plot of year-on-yar KSI rates for pedestrian-vehicle crashes</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section></section><section id="techniques" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="techniques">
<span class="header-section-number">7.3</span> Techniques</h2>


</section></main><!-- /main --><script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"function rStyle(roughness) {\n  const rStyle = {roughness: roughness};\n  rStyle;\n  return(rStyle)\n}\n\nfunction drawPointsSketch(r, pts) {\n  pts.map(function(d) { \n    r.setRoughStyle(rStyle(d.roughness))\n    .fill(\"#636363\").ellipse(d.x, d.y, .3)} )\nreturn r;\n}\n\nfunction drawPointsSize(r, pts) {\n  pts.map(function(d) { r.fill(\"#636363\").strokeWidth(0).ellipse(d.x, d.y, d.size)} )\nreturn r;\n}\nfunction drawPointsColour(r, pts) {\n  pts.map(function(d) { r.fill(d.cls).strokeWidth(0).ellipse(d.x, d.y, .3)} )\nreturn r;\n}\n\nfunction drawPointsAlpha(r, pts) {\n  pts.map(function(d) { \n    r.strokeWidth(1).stroke(d.alphs).fill(\"#ffffff00\").ellipse(d.x, d.y, .35)\n    r.strokeWidth(2).line([[d.x, .65], [d.x, 1.35]])\n    r.line([[d.x-.35, d.y], [d.x+.35, d.y]])\n    r.fill(d.alphs).strokeWidth(0).ellipse(d.x, d.y, .25)\n    } )\nreturn r;\n}\n\nfunction drawPointsLocation(r, pts) {\n  pts.map(function(d) {\n    r.strokeWidth(1).stroke(\"#636363\").fill(\"#ffffff00\").ellipse(d.x, d.y, .35)\n    r.strokeWidth(.8).line([[d.x, .65], [d.x, 1.35]])\n    r.line([[d.x-.35, d.y], [d.x+.35, d.y]])\n    r.strokeWidth(0).fill(\"#636363\").\n    ellipse(\n      d.x + ((Math.round(Math.random()) * 2 - 1)* .5*(d.location)), \n      d.y + ((Math.round(Math.random()) * 2 - 1)* .5*(d.location)), \n      .05)\n    } )\nreturn r;\n}\n\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"import { Renderer } from \"@jwolondon/renderer\"\nimport { aq, op } from '@uwdata/arquero'\nw = 480;\nh = 50;\nborder = 1;\n\ntestDat = aq.table({\n    x: [2.2, 3.2, 4.2, 5.2, 6.2, 7.2],\n    y: [1, 1, 1, 1, 1, 1],\n    size: [.35, .3, .25, .2, .15, .1],\n    cls: [\"#252525\", \"#525252\", \"#737373\", \"#969696\", \"#bdbdbd\", \"#d9d9d9\"],\n    alphs: [\"#252525E6\", \"#252525BF\", \"#25252599\", \"#25252573\", \"#25252559\", \"#25252533\"],\n    location: [.01, .18, .25, .32, .38, .45],\n    roughness: [0.2, 1, 2, 3, 4.2, 6.5]\n  });\n\nxSc = d3\n   .scaleLinear()\n   .domain([0,9.5])\n   .range([border, w - border]);\nySc = d3\n    .scaleLinear()\n    .domain([0.5, 1.5])\n    .range([h - border, border]);\n\n\nr0 = new Renderer(w, h-10, \"svg\")\n  .setScales(xSc, ySc)\n  .font(\"Avenir Next Ultra Light\")\n  .textAlign(\"left\")\n  .textBaseline(\"middle\")\n  .textSize(10)\n  .text(\"certain\",1.8,1)\n  .textAlign(\"right\")\n  .text(\"uncertain\", 7.3,1)\n  .line([[2.8,1], [6,1]])\nr0.render(); \n\nr1 = new Renderer(w, h, \"svg\")\n  .setScales(xSc, ySc)\n  .font(\"Avenir Next Ultra Light\")\n  .textAlign(\"left\")\n  .textBaseline(\"middle\")\n  .textSize(10)\n  .text(\"size\",0,1)\ndrawPointsSize(r1, testDat.objects()).render();\n\nr2 = new Renderer(w, h, \"svg\")\n  .setScales(xSc, ySc)\n  .font(\"Avenir Next Ultra Light\")\n  .textAlign(\"left\")\n  .textBaseline(\"middle\")\n  .textSize(10)\n  .text(\"colour\",0,1)\ndrawPointsColour(r2, testDat.objects()).render();\n\nr3 = new Renderer(w, h, \"svg\")\n  .setScales(xSc, ySc)\n  .font(\"Avenir Next Ultra Light\")\n  .textAlign(\"left\")\n  .textBaseline(\"middle\")\n  .textSize(10)\n  .text(\"transparency\",0,1)\ndrawPointsAlpha(r3, testDat.objects()).render();\n\nr4 = new Renderer(w, h, \"svg\")\n  .setScales(xSc, ySc)\n  .font(\"Avenir Next Ultra Light\")\n  .textAlign(\"left\")\n  .textBaseline(\"middle\")\n  .textSize(10)\n  .text(\"location\",0,1)\ndrawPointsLocation(r4, testDat.objects()).render();\n\nr5 = new Renderer(w, h, \"roughsvg\")\n  .setScales(xSc, ySc)\n  .font(\"Avenir Next Ultra Light\")\n  .textAlign(\"left\")\n  .textBaseline(\"middle\")\n  .textSize(10)\n  .text(\"sketchy\",0,1)\ndrawPointsSketch(r5, testDat.objects()).render();\n\n"}]}
</script><script type="module">
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./06-model.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-storytelling.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Storytelling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>